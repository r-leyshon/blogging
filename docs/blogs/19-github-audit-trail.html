<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rich Leyshon">
<meta name="dcterms.date" content="2024-10-13">
<meta name="description" content="Building a Better Audit Trail with GitHub">

<title>Commit with Clarity – The Data Savvy Corner</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<link href="..//./favicon.ico" rel="icon">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6658778373981809" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../www/styles.css">
<link rel="stylesheet" href=".././www/17-quarto-comments/styles.css">
<meta property="og:title" content="Commit with Clarity – The Data Savvy Corner">
<meta property="og:description" content="Building a Better Audit Trail with GitHub">
<meta property="og:image" content="https://i.imgur.com/iwVPwPG.png">
<meta property="og:site_name" content="The Data Savvy Corner">
<meta property="og:image:alt" content="A cute cat-like character inspects code with a magnifying glass.">
<meta name="twitter:title" content="Commit with Clarity – The Data Savvy Corner">
<meta name="twitter:description" content="Building a Better Audit Trail with GitHub">
<meta name="twitter:image" content="https://i.imgur.com/iwVPwPG.png">
<meta name="twitter:site" content="@Rich_L1984">
<meta name="twitter:image:alt" content="A cute cat-like character inspects code with a magnifying glass.">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">The Data Savvy Corner</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blogs/index.html"> 
<span class="menu-text">Technical Blogs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../music-reviews/index.html"> 
<span class="menu-text">Music</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../book-reviews/index.html"> 
<span class="menu-text">Books</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://twitter.com/Rich_L1984" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter-x"></i></a>
    <a href="https://github.com/r-leyshon" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/richard-leyshon-316121163/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#intended-audience" id="toc-intended-audience" class="nav-link" data-scroll-target="#intended-audience">Intended Audience</a></li>
  </ul></li>
  <li><a href="#commit-messages" id="toc-commit-messages" class="nav-link" data-scroll-target="#commit-messages">Commit Messages</a></li>
  <li><a href="#link-prs-with-issues" id="toc-link-prs-with-issues" class="nav-link" data-scroll-target="#link-prs-with-issues">Link PRs with Issues</a></li>
  <li><a href="#consider-your-merge-strategy" id="toc-consider-your-merge-strategy" class="nav-link" data-scroll-target="#consider-your-merge-strategy">Consider Your Merge Strategy</a>
  <ul class="collapse">
  <li><a href="#rebase-merge" id="toc-rebase-merge" class="nav-link" data-scroll-target="#rebase-merge">Rebase Merge</a></li>
  <li><a href="#squash-and-merge" id="toc-squash-and-merge" class="nav-link" data-scroll-target="#squash-and-merge">Squash and Merge</a></li>
  <li><a href="#merge-commit" id="toc-merge-commit" class="nav-link" data-scroll-target="#merge-commit">Merge Commit</a></li>
  <li><a href="#overview-of-merge-strategies" id="toc-overview-of-merge-strategies" class="nav-link" data-scroll-target="#overview-of-merge-strategies">Overview of Merge Strategies</a></li>
  <li><a href="#selecting-a-merge-strategy" id="toc-selecting-a-merge-strategy" class="nav-link" data-scroll-target="#selecting-a-merge-strategy">Selecting a Merge Strategy</a></li>
  </ul></li>
  <li><a href="#organising-issues" id="toc-organising-issues" class="nav-link" data-scroll-target="#organising-issues">Organising Issues</a></li>
  <li><a href="#tips-for-auditing" id="toc-tips-for-auditing" class="nav-link" data-scroll-target="#tips-for-auditing">Tips for Auditing</a>
  <ul class="collapse">
  <li><a href="#assign-blame" id="toc-assign-blame" class="nav-link" data-scroll-target="#assign-blame">Assign BLAME</a></li>
  <li><a href="#grep-ftw" id="toc-grep-ftw" class="nav-link" data-scroll-target="#grep-ftw">Grep FTW</a></li>
  <li><a href="#github-vscode" id="toc-github-vscode" class="nav-link" data-scroll-target="#github-vscode">GitHub &amp; VSCode</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements">Acknowledgements</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Commit with Clarity</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Explanation</div>
    <div class="quarto-category">GitHub</div>
    <div class="quarto-category">Git</div>
    <div class="quarto-category">Version Control</div>
    <div class="quarto-category">Software Development</div>
    <div class="quarto-category">Blame</div>
    <div class="quarto-category">VSCode</div>
    <div class="quarto-category">Git Grep</div>
  </div>
  </div>

<div>
  <div class="description">
    Building a Better Audit Trail with GitHub
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rich Leyshon </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 13, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><img class="shaded_box" src="https://i.imgur.com/iwVPwPG.png" alt="A cute cat-like character inspects code with a magnifying glass." style="display:block;margin-left:auto;margin-right:auto;width:60%;border:none;"></p>
<blockquote class="blockquote">
<p>“You don’t need version control any more than a trapese [sic] artist needs a safety net.” Mark Cidade, <a href="https://stackoverflow.com/posts/250991/revisions" target="_blank">Stack Overflow</a></p>
</blockquote>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Most developers spend time reading other people’s code - for Pull Reviews (PRs) or to learn more about a software package, for example. Every so often, a developer may need to review an entire repository and possibly even its commit history. This can happen when publishing a mature codebase.</p>
<p>Making sense of other peoples’ commit histories can be challenging, especially if that work is exploratory. Understanding the myriad reasons for any single change after the fact is reliant upon whether the developer had time to document their reasons for their implementation. Even if you work alone, perhaps that other developer will be yourself at times. Needing to pick through your code’s commit history in order to find a bug-free version.</p>
<p>The good news is that there are a few tools that Git and GitHub can provide us, and one or two easy habits that will greatly assist your colleagues in comprehending your Git activity. In fact, the GitHub User Interface (UI) is designed in subtle ways, to nudge you towards some of these behaviours. The sort of things that are not required but are incredibly helpful to others - including your future self.</p>
<iframe src="https://giphy.com/embed/TtlYafuP93f5FxemDU" style="display:block;margin-left:auto;margin-right:auto;width:60%;height:275px;border:none;" class="iframey shaded_box" allowfullscreen="">
</iframe>
<p><br> Read on for more on how to be kind to yourself, and those poor souls who need to read your work - GitHub has your back.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Opinions Ahead… (click to expand)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Every Git user has their own way of doing things. Many experts on the matter have diverging opinions on pretty much everything Git has to offer. In this article, I am offering a medley of advice from colleagues, trial, error and pain incurred. I’d bet that not all the advice here will chime with you.</p>
<p>This article will include a fair amount of opinion &amp; appreciation for how GitHub helps promote considerate behaviours. You are most welcome to disagree and share your own opinions. There is a comments section at the bottom of the page to facilitate that.</p>
</div>
</div>
</div>
<section id="intended-audience" class="level3">
<h3 class="anchored" data-anchor-id="intended-audience">Intended Audience</h3>
<p>Programmers who use GitHub to share code. The kind of Programmers who:</p>
<ul>
<li>may not have used GitHub to collaborate in teams (previously me).</li>
<li>pride themselves on knowing ‘just enough Git to survive’ (me).</li>
<li>have been using GitHub for many years and wonder if their behaviours can be adjusted to be more helpful to others (future me).</li>
</ul>
</section>
</section>
<section id="commit-messages" class="level2">
<h2 class="anchored" data-anchor-id="commit-messages">Commit Messages</h2>
<p>One of the most ‘freeing’ style guide rules an organisation can institute are rules for what it considers to be good commit messages. Having enough rules to help take the pondering out of writing your message content will help get you back onto the development work quicker.</p>
<p>Having well-structured commit messages also helps others to quickly understand the types of changes that have been implemented in a pull request (PR). Some of my previous colleagues took the time to put together <a href="https://datasciencecampus.github.io/coding-standards/version-control.html" target="_blank">guidance on such matters</a>.</p>
<blockquote class="blockquote">
<p>” <code>&lt;type&gt;: &lt;subject&gt;</code></p>
<p>type</p>
<p>Must be one of the following:</p>
<ul>
<li>feat: A new feature</li>
<li>fix: A bug fix</li>
<li>doc: Documentation only changes</li>
<li>style: Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc)</li>
<li>refactor: A code change that neither fixes a bug or adds a feature</li>
<li>perf: A code change that improves performance</li>
<li>test: Adding missing tests</li>
<li>chore: Changes to the build process or auxiliary tools and libraries such as documentation generation Do not capitalise the first letter.</li>
</ul>
<p>subject</p>
<p>The subject contains succinct description of the change:</p>
<ul>
<li>use the imperative, present tense: “Change” not “Changed” nor “Changes”</li>
<li>do capitalise first letter</li>
<li>no dot (.) at the end”</li>
</ul>
</blockquote>
<p>Many thanks to those Predeleagues (Predecessor Colleagues, my own portmanteau) who took the time to write that guidance.</p>
<p>This has been super useful for 99% of my commit messages that are one-liners. On the odd occasion I’ve felt a multi-line message was required, having the guidance for that written down has been a priceless time-saver. Using a commit type has also helped in moving backwards through the version history - helping my future self to target specific refactoring diffs or taking a rummage through a feature that introduced some newly discovered bug.</p>
<p>Considering the commit subject, I would subscribe to <a href="https://best-practice-and-impact.github.io/qa-of-code-guidance/version_control.html#write-short-and-informative-commits" target="_blank">ONS Duck Book’s advice</a> - aspire to short and informative messages.</p>
</section>
<section id="link-prs-with-issues" class="level2">
<h2 class="anchored" data-anchor-id="link-prs-with-issues">Link PRs with Issues</h2>
<p>To those poor souls who have jobs that involve reading through commit logs - we salute you.</p>
<p>Oftentimes understanding the <strong>reason</strong> for a commit can become a mystery. Trying to understand the purpose of some contextless diff can become a real chore. By ensuring that each PR is linked with an issue (or issues), we can help provide the context needed to anyone who needs to pick through or pick apart our code.</p>
<p>The GitHub UI helps to nudge us in the right direction. Below I create a new issue in the repo for this blog:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.imgur.com/kvkwrW0.png" class="img-fluid figure-img"></p>
<figcaption>Creating an issue in GitHub</figcaption>
</figure>
</div>
<p>Notice that there is an option on the right hand side, under <code>Development</code> to <code>Create a branch</code> for this issue. Click this and GitHub will create a branch with a naming convention that links the branch to the issue.</p>
<p><img src="https://i.imgur.com/2EOE623.png" alt="Creating a new branch from an issue in GitHub" style="display:block;margin-left:auto;margin-right:auto;" width="50%"></p>
<p>Once finished with the branch, we raise a PR. To link the PR with the issue, ensure to use one of <a href="https://docs.github.com/en/get-started/writing-on-github/working-with-advanced-formatting/using-keywords-in-issues-and-pull-requests#linking-a-pull-request-to-an-issue" target="_blank">GitHub’s keywords</a> to automatically close the issue on merge. In this example, including the line <code>Fixes #71</code> in a comment within the PR will link the issue. Several issues can be linked in this way, eg <code>Fixes #71, Resolves #72</code> and so on. In this way, we have given an issue, branch and PR a clear identity.</p>
</section>
<section id="consider-your-merge-strategy" class="level2">
<h2 class="anchored" data-anchor-id="consider-your-merge-strategy">Consider Your Merge Strategy</h2>
<p>When merging a PR in the GitHub UI, 3 options are presented:</p>
<ul>
<li>Merge commit (the default)</li>
<li>Squash and merge</li>
<li>Rebase and merge</li>
</ul>
<p>These options are a little involved and I would recommend reading <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/incorporating-changes-from-a-pull-request/about-pull-request-merges" target="_blank">GitHub’s merge docs</a> on the matter for a more detailed breakdown.</p>
<p>To help visualise the differences in these approaches, consider the following diagram:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://matt-rickard.com/static/image/squash-merge-or-rebase/1.webp" class="img-fluid figure-img"></p>
<figcaption>Source: <a href="https://matt-rickard.com/squash-merge-or-rebase" target="blank">matt-rickard.com</a></figcaption>
</figure>
</div>
<p>In the following scenarios, I will walk through commit history following the three different merges. In all examples, I will refer to the target branch receiving the commits as <code>main</code> and the topic branch containing the additions as <code>feature</code>.</p>
<section id="rebase-merge" class="level3">
<h3 class="anchored" data-anchor-id="rebase-merge">Rebase Merge</h3>
<p>When a rebase merge is used, new commits that mirror those in <code>feature</code> branch are created in <code>main</code>. You keep every commit and maintain a linear commit history. In the diagram below, I compare commits in <a href="https://github.com/r-leyshon/rebase-merge-example" target="_blank">a repo with an example rebase merge</a>. Note that there are 2 commits from <code>feature</code> branch with commit messages like “FEATURE: …”. Merging the PR creates new commits to <code>main</code>, which have all the file edits from <code>feature</code>. However, note that these new commits have different hashes to those in <code>feature</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://i.imgur.com/M7ZMT4i.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Comparing main and feature following rebase merge. Click to enlarge."><img src="https://i.imgur.com/M7ZMT4i.png" class="img-fluid figure-img" alt="Comparing main and feature following rebase merge. Click to enlarge."></a></p>
<figcaption>Comparing <code>main</code> and <code>feature</code> following rebase merge. Click to enlarge.</figcaption>
</figure>
</div>
</section>
<section id="squash-and-merge" class="level3">
<h3 class="anchored" data-anchor-id="squash-and-merge">Squash and Merge</h3>
<p>On selecting “Squash and merge” in the GitHub UI, A new “summary commit” is created in <code>main</code>. This condenses all of the file changes from <code>feature</code> into a single, new commit. You can see that even in the trivial example <a href="https://github.com/r-leyshon/squash-commit-example" target="_blank">squash merge repository</a>, the outcome is that <code>main</code> branch will be much more succinct than in the other merge strategies.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://i.imgur.com/NbfJjZD.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Comparing main and feature following a squash merge. Click to enlarge."><img src="https://i.imgur.com/NbfJjZD.png" class="img-fluid figure-img" alt="Comparing main and feature following a squash merge. Click to enlarge."></a></p>
<figcaption>Comparing <code>main</code> and <code>feature</code> following a squash merge. Click to enlarge.</figcaption>
</figure>
</div>
<p>Inspecting the automated squash merge commit message demonstrates how GitHub summarises the activity from <code>feature</code> branch.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.imgur.com/KBznXhf.png" class="img-fluid figure-img"></p>
<figcaption>Squash commit generated commit message.</figcaption>
</figure>
</div>
<p>The squash merge strategy is a good candidate for busy projects with many contributors. It’s also a neat way to avoid noise in your version history, such as experimental ‘cruft’ or benign changes that you’d rather summarise. It is important to note that once merged to <code>main</code>, you should go ahead and delete the <code>feature</code> branch. If you continue to work in <code>feature</code>, there is a likelihood of diverging with <code>main</code>, ending up in merge conflicts to resolve.</p>
</section>
<section id="merge-commit" class="level3">
<h3 class="anchored" data-anchor-id="merge-commit">Merge Commit</h3>
<p>Finally, we consider the default merge behaviour - the <a href="https://github.com/r-leyshon/merge-commit-example" target="_blank">merge commit</a>. This behaviour will create a new commit in <code>main</code> that introduces the changes in <code>feature</code>. Notice that in this scenario, the commits in <code>main</code> and <code>feature</code> share the same content and commit hashes, as opposed to a rebase merge which “pretends” those commits happened in <code>main</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://i.imgur.com/BiuYZAv.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Comparing main and feature following a merge commit. Click to enlarge."><img src="https://i.imgur.com/BiuYZAv.png" class="img-fluid figure-img" alt="Comparing main and feature following a merge commit. Click to enlarge."></a></p>
<figcaption>Comparing <code>main</code> and <code>feature</code> following a merge commit. Click to enlarge.</figcaption>
</figure>
</div>
<p>This is perhaps the noisiest merge strategy, as the commits of each feature branch are all merged to main, plus an additional commit that marks the merge. Use this scenario if you consider it really important to be able to revisit the commit history.</p>
</section>
<section id="overview-of-merge-strategies" class="level3">
<h3 class="anchored" data-anchor-id="overview-of-merge-strategies">Overview of Merge Strategies</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Merge Type</strong></th>
<th><strong>What Happens</strong></th>
<th><strong>How It Looks</strong></th>
<th><strong>Best For</strong></th>
<th><strong>Downside</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Merge Commit</strong></td>
<td>A new commit is created to merge the PR, keeping all individual commits intact.</td>
<td>A merge commit is added, and you can see all the individual commits from the PR.</td>
<td>Keeping a detailed history with all commits preserved.</td>
<td>Can clutter the commit history with many small or trivial commits.</td>
</tr>
<tr class="even">
<td><strong>Squash and Merge</strong></td>
<td>All commits in the PR are combined into one single commit before merging.</td>
<td>Only one commit appears in the history, representing all changes from the PR.</td>
<td>Keeping the commit history clean and concise.</td>
<td>Loses the individual commit details from the PR.</td>
</tr>
<tr class="odd">
<td><strong>Rebase and Merge</strong></td>
<td>The commits from the PR are applied directly on top of the main branch, maintaining their original structure but without a merge commit.</td>
<td>The history looks linear, with the PR commits applied after the latest main branch commit, with no merge commit in between.</td>
<td>Keeping a linear, clean commit history without merge commits.</td>
<td>Can be tricky with conflicts, especially for complex histories.</td>
</tr>
</tbody>
</table>
</section>
<section id="selecting-a-merge-strategy" class="level3">
<h3 class="anchored" data-anchor-id="selecting-a-merge-strategy">Selecting a Merge Strategy</h3>
<p>Understanding which strategy is for the best depends on the context in which you’re working. Your 2 options for maintaining a full commit history are either merge commit or rebase and merge. If you would rather summarise the commit history, then squash commit is the right approach. If I’m working on a solo project, I tend to merge commit. If I’m working in a team, I tend to squash commit in order to keep the version history manageable.</p>
<p>Some people bemoan the squash commit approach, with 2 main complaints that I’ve encountered:</p>
<ol type="1">
<li>The full commit history is not preserved.</li>
<li>It decreases contributors’ apparent GitHub activity.</li>
</ol>
<p>My responses follow:</p>
<ol type="1">
<li>Deleted branches can be restored.</li>
<li>GitHub activity is a poor proxy for impact.</li>
</ol>
<p>Admittedly, the squash merge approach works best for projects where there is a disciplined approach to PRs. If PRs represent a tangible unit of work, such as a bug is fixed or a new feature is implemented, then squash merge works really well in my experience. Individual branches are short-lived and the risk of merge conflicts are minimised.</p>
<p>However, some projects are not like that. Particularly in exploratory work where some PRs become sprawling, long-lived with diffs numbering tens-of-thousands of lines. It may be advisable to merge commit in those scenarios. Personally, <a href="https://git-scm.com/book/en/v2/Git-Branching-Rebasing#_rebase_peril" target="_blank">I never rebase</a> when working with others.</p>
</section>
</section>
<section id="organising-issues" class="level2">
<h2 class="anchored" data-anchor-id="organising-issues">Organising Issues</h2>
<p>Issues provide the context for PRs. Understanding why a PR is necessary is very helpful to collaborators and will be appreciated by anyone who needs to look back over your version history.</p>
<p>A feature that I consider to be under-utilised in GitHub are <a href="https://docs.github.com/en/issues/using-labels-and-milestones-to-track-work/about-milestones" target="_blank">milestones</a>. The milestone feature allows you to group related work, such as grouping issues and PRs with an epic. These milestones can then be added to GitHub projects to coordinate burn-down effort. Find the milestones interface under the issues tab.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://i.imgur.com/eJuzMcX.png%22" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="GitHub Milestone interface. Click to expand."><img src="https://i.imgur.com/eJuzMcX.png%22" class="img-fluid figure-img" alt="GitHub Milestone interface. Click to expand."></a></p>
<figcaption>GitHub Milestone interface. Click to expand.</figcaption>
</figure>
</div>
<p>Adding this sort of structure can be great in helping collaborators understand where your work fits into more tangible delivery, and your product managers will thank you for it. Below I show how with a few clicks, the milestone can be used to create an informative delivery roadmap.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://i.imgur.com/fEwDSUB.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Milestone on a GitHub roadmap. Click to expand."><img src="https://i.imgur.com/fEwDSUB.png" class="img-fluid figure-img" alt="Milestone on a GitHub roadmap. Click to expand."></a></p>
<figcaption>Milestone on a GitHub roadmap. Click to expand.</figcaption>
</figure>
</div>
<p>You can see in the project that I have grouped the issues by milestone on the left hand-side. Also, by adding the milestone to the date fields, you get the blue date line appearing on the roadmap to the right of the screen.</p>
<p>Recently, GitHub has unveiled some significant <a href="https://github.blog/changelog/2024-10-01-evolving-github-issues-public-beta/" target="_blank">changes to its issues</a>. The nested issues feature adds even more flexibility in grouping units of work together. This feature is in public beta at time of writing. <a href="https://github.com/features/issues/signup" target="_blank">Join the waitlist here</a>.</p>
</section>
<section id="tips-for-auditing" class="level2">
<h2 class="anchored" data-anchor-id="tips-for-auditing">Tips for Auditing</h2>
<p>If you are tasked with making sense of someone else’s code for PR or commit history for a release, then there are a few tools &amp; tricks that can help make your life a bit easier. I’ll cover some of them here.</p>
<section id="assign-blame" class="level3">
<h3 class="anchored" data-anchor-id="assign-blame">Assign BLAME</h3>
<blockquote class="blockquote">
<p>“It is ill to praise, and worse to blame, the thing which you do not understand.” Leonardo da Vinci, “Life, art and science, the thoughts of Leonardo”, p.67, 2013, Lulu.com</p>
</blockquote>
<p>At times, it may be useful to identify the person who wrote some code. It’s not completely obvious, but by viewing a file and toggling from <code>Preview</code> to <code>Blame</code>, you get a line-by-line view of who commited what and when.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://i.imgur.com/17wmNNG.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="GitHub blame view. Click to expand."><img src="https://i.imgur.com/17wmNNG.png" class="img-fluid figure-img" alt="GitHub blame view. Click to expand."></a></p>
<figcaption>GitHub blame view. Click to expand.</figcaption>
</figure>
</div>
<p>Note that there are also handy tools such as <a href="https://marketplace.visualstudio.com/items?itemName=eamodio.gitlens" target="_blank">GitLens for VSCode</a> that can bring the Git blame into your IDE.</p>
</section>
<section id="grep-ftw" class="level3">
<h3 class="anchored" data-anchor-id="grep-ftw">Grep FTW</h3>
<p>If you need to check all occurrences of a specific pattern anywhere within a repository, there’s a great little tool called <code>git grep</code> that will help. In an interactive terminal, run <code>git grep &lt;INSERT_PATTERN&gt;</code> and all occurrences of that pattern within any file contents will be returned. If the pattern has spaces, just wrap the pattern in speech marks.</p>
<p>If there are loads of files and you want to search for a pattern in the filenames, then use:</p>
<p><code>git ls-files | grep &lt;INSERT_PATTERN&gt;</code></p>
<p>If you’d like to search for specific patterns in commit messages:</p>
<p><code>git log --grep=&lt;INSERT_PATTERN&gt;</code></p>
<p>If you need to scan an entire commit history for the presence of a pattern in the contents of the files, then this is achieved with</p>
<p><code>git log -G &lt;INSERT_PATTERN&gt;</code></p>
<p>That pattern takes regular expressions so it can be quite flexible in combination with wildcards. This is super useful if you need to check whether a specific secret was ever added to the commit history.</p>
</section>
<section id="github-vscode" class="level3">
<h3 class="anchored" data-anchor-id="github-vscode">GitHub &amp; VSCode</h3>
<p>The previous tip is a feature of Git rather than GitHub. In order to execute the commands, you’ll need a Command Line Interface and a local clone of the repository. That might not always be convenient. Did you know that since the low(ish) key Microsoft takeover of GitHub, you can now access VSCode directly from the GitHub UI?</p>
<p>By simply typing <code>.</code> (full stop or period, depending on what side of the Atlantic you learned English) you will open your repository within VSCode directly within your browser window. If you’d prefer to open VSCode in a new browser window, type <code>&gt;</code> instead. This interface is handy for adding in new files or adjusting the content of existing files.</p>
<p>If you’d like an interactive terminal, or to test out code, you’ll need to switch over to GitHub Codespaces. Again, this is a free service that GitHub provide that provisions some compute for you. To launch a ‘live’ version of VSCode in your browser, click on the burger icon in in the ribbon to the left, then <code>Terminal</code> -&gt; <code>New Terminal</code>. You will be presented with options in the terminal asking you to launch GitHub Codespaces or to continue in a local clone of the repo.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://i.imgur.com/ZnqzMi2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Launching Codespaces. Click to expand."><img src="https://i.imgur.com/ZnqzMi2.png" class="img-fluid figure-img" alt="Launching Codespaces. Click to expand."></a></p>
<figcaption>Launching Codespaces. Click to expand.</figcaption>
</figure>
</div>
<p>Once Codespaces is launched, you have an interactive terminal to carry out your favourite operations. Here I’m displaying the <code>git grep</code> command in my browser with Codespaces.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://i.imgur.com/jRigeEl.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Running terminal operations with Codespaces. Click to expand."><img src="https://i.imgur.com/jRigeEl.png" class="img-fluid figure-img" alt="Running terminal operations with Codespaces. Click to expand."></a></p>
<figcaption>Running terminal operations with Codespaces. Click to expand.</figcaption>
</figure>
</div>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>In this article we covered considerate Git practice and how GitHub helps to nudge us toward these behaviours. Specifically:</p>
<ul>
<li><strong>Commit Messages</strong>: The value of having well-structured commit messages.</li>
<li><strong>Linking PRs with Issues</strong>: Providing necessary context for reviewers.</li>
<li><strong>Merge Strategies</strong>: Advantages and disadvantages of the options GitHub provides in their UI.</li>
<li><strong>Organising Issues</strong>: Using milestones to group related work, enhancing coordination in projects.</li>
<li><strong>Tips for Auditing</strong>: Tools and techniques for inspecting a commit history, including the use of Git blame and grep commands.</li>
<li><strong>GitHub &amp; VSCode Integration</strong>: Describes how to access VSCode directly from GitHub for streamlined code management.</li>
</ul>
<p>Please feel free to share your own thoughts and ideas in the comment section below (GitHub login required)! If you spot an error with this article, or have a suggested improvement then feel free to <a href="https://github.com/r-leyshon/blogging/issues">raise an issue on GitHub</a>.</p>
</section>
<section id="acknowledgements" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h2>
<p>To past and present colleagues who have helped to discuss pros and cons, establishing practice and firming-up some opinions. Particularly:</p>
<ul>
<li>Ian</li>
<li>Rob</li>
<li>Adrian</li>
<li><a href="https://www.youtube.com/watch?v=BCQHnlnPusY" target="_blank">Dan Shiffman</a></li>
</ul>
<p id="fin">
<i>fin!</i>
</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/thedatasavvycorner\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="r-leyshon/blogging" data-repo-id="R_kgDOJ7xM-w" data-category="Announcements" data-category-id="DIC_kwDOJ7xM-84Chxs3" data-mapping="url" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="cobalt" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="cobalt">
<input type="hidden" id="giscus-alt-theme" value="cobalt">
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","loop":false,"descPosition":"bottom","selector":".lightbox","closeEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>