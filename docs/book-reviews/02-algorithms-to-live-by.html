<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rich Leyshon">
<meta name="dcterms.date" content="2023-09-23">
<meta name="description" content="Thoughts on Brian Christian &amp; Tom Griffiths treatment of applied computer science.">

<title>The Data Savvy Corner - UNDER CONSTRUCTION: Algorithms to Live By</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<link href="..//./www/favicon.ico" rel="icon">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6658778373981809" crossorigin="anonymous"></script>


<link rel="stylesheet" href="../www/styles.css">
<meta property="og:title" content="The Data Savvy Corner - UNDER CONSTRUCTION: Algorithms to Live By">
<meta property="og:description" content="Thoughts on Brian Christian &amp; Tom Griffiths treatment of applied computer science.">
<meta property="og:image" content="https://images.rawpixel.com/image_400/cHJpdmF0ZS9sci9pbWFnZXMvd2Vic2l0ZS8yMDIyLTA1L2ZsMjI2MTMzNTM5MjUtaW1hZ2Uta3A0dzFscHAuanBn.jpg">
<meta property="og:site-name" content="The Data Savvy Corner">
<meta property="og:image:alt" content="Low-level radio-frequency controller for magnetron.">
<meta name="twitter:title" content="The Data Savvy Corner - UNDER CONSTRUCTION: Algorithms to Live By">
<meta name="twitter:description" content="Thoughts on Brian Christian &amp; Tom Griffiths treatment of applied computer science.">
<meta name="twitter:image" content="https://images.rawpixel.com/image_400/cHJpdmF0ZS9sci9pbWFnZXMvd2Vic2l0ZS8yMDIyLTA1L2ZsMjI2MTMzNTM5MjUtaW1hZ2Uta3A0dzFscHAuanBn.jpg">
<meta name="twitter:site" content="@Rich_L1984">
<meta name="twitter:image:alt" content="Low-level radio-frequency controller for magnetron.">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">The Data Savvy Corner</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../index.xml" rel="" target=""><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blogs/index.html" rel="" target="">
 <span class="menu-text">Byte-Wise Musings</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../music-reviews/index.html" rel="" target="">
 <span class="menu-text">Productivity Pulse</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../book-reviews/index.html" rel="" target="">
 <span class="menu-text">Bookmarked Insights</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a>
  <ul class="collapse">
  <li><a href="#on-the-authors" id="toc-on-the-authors" class="nav-link" data-scroll-target="#on-the-authors">On the Authors</a></li>
  </ul></li>
  <li><a href="#an-overview-of-the-book" id="toc-an-overview-of-the-book" class="nav-link" data-scroll-target="#an-overview-of-the-book">An Overview of the Book</a></li>
  <li><a href="#chapters" id="toc-chapters" class="nav-link" data-scroll-target="#chapters">Chapters</a>
  <ul class="collapse">
  <li><a href="#a-gentle-introduction-to-operational-research" id="toc-a-gentle-introduction-to-operational-research" class="nav-link" data-scroll-target="#a-gentle-introduction-to-operational-research">A Gentle Introduction to Operational Research</a></li>
  <li><a href="#optimal-stopping" id="toc-optimal-stopping" class="nav-link" data-scroll-target="#optimal-stopping">Optimal Stopping</a></li>
  <li><a href="#sorting" id="toc-sorting" class="nav-link" data-scroll-target="#sorting">3: Sorting</a></li>
  <li><a href="#caching" id="toc-caching" class="nav-link" data-scroll-target="#caching">4: Caching</a></li>
  <li><a href="#overfitting" id="toc-overfitting" class="nav-link" data-scroll-target="#overfitting">7: Overfitting</a></li>
  <li><a href="#game-theory" id="toc-game-theory" class="nav-link" data-scroll-target="#game-theory">11: Game Theory</a></li>
  </ul></li>
  <li><a href="#analysis-and-evaluation" id="toc-analysis-and-evaluation" class="nav-link" data-scroll-target="#analysis-and-evaluation">Analysis and Evaluation</a></li>
  <li><a href="#comparisons" id="toc-comparisons" class="nav-link" data-scroll-target="#comparisons">Comparisons</a></li>
  <li><a href="#recommendation" id="toc-recommendation" class="nav-link" data-scroll-target="#recommendation">Recommendation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">UNDER CONSTRUCTION: Algorithms to Live By</h1>
<p class="subtitle lead">The Computer Science of Human Decisions</p>
  <div class="quarto-categories">
    <div class="quarto-category">Mathematical Modelling</div>
    <div class="quarto-category">Computer Science</div>
  </div>
  </div>

<div>
  <div class="description">
    Thoughts on Brian Christian &amp; Tom Griffiths treatment of applied computer science.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rich Leyshon </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 23, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<figure class="center figure">
<img class="shaded_box figure-img" src="https://images.rawpixel.com/image_400/cHJpdmF0ZS9sci9pbWFnZXMvd2Vic2l0ZS8yMDIyLTA1L2ZsMjI2MTMzNTM5MjUtaW1hZ2Uta3A0dzFscHAuanBn.jpg" alt="Low-level radio-frequency controller for magnetron.." width="400px">
<figcaption class="figure-caption">
Image credit: <a href="https://www.rawpixel.com/" class="uri">https://www.rawpixel.com/</a>
</figcaption>
</figure>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>As of today’s date, Algorithms to Live By (AtLB) scores an average of 4.13 / 5.00 across over 2.5k ratings on <a href="https://www.goodreads.com/book/show/25666050-algorithms-to-live-by">goodreads</a>.</p>
<p>AtLB made the <a href="https://www.technologyreview.com/2016/12/23/243930/best-books-of-2016/">MiT Technology Review Best Books of 2016</a> and <a href="https://www.forbes.com/sites/daviddisalvo/2016/12/19/the-best-brain-books-of-2016/">Forbes’ Must Read Brain Books</a> of the same year.</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>AtLB is a fantastic read for those naive to the complexity of computer science and how it can be applied to everyday life. From deciding whether to try a new restaurant, how best to go about finding your next home to optimising your socks draw. It turns out, the big brains in modern history have already solved these problems. The authors take us through the surprising implications that computer science can have for how we muddle through things, keeping things light and accessible enough to be categorised under popular science. Though the authors manage not to undersell sell the impact and after reading this book, you will never think about sorting in the same way again.</p>
<section id="on-the-authors" class="level3">
<h3 class="anchored" data-anchor-id="on-the-authors">On the Authors</h3>
<p>Tom Griffiths is a celebrated Princeton professor in computational cognition and director of the University’s Computational Cognitive Science Laboratory <span class="citation" data-cites="PrinceCCSL"><a href="#ref-PrinceCCSL" role="doc-biblioref">[1]</a></span>. The recipient of numerous awards and a leader in applied artificial intelligence research, Griffiths has many influential papers across a diverse set of problem spaces: Causal inference, natural language processing and pedagogy.</p>
<p>Brian Christian has written several award winning works of non-fiction, notably “The Alignment Problem” which examines machine learning ethics, for which he received numerous awards. A visiting scholar at the University of California, Berkeley; Christian’s expertise ranges from programming to poetry, earning his laureate at San Francisco Public Library in 2016.</p>
</section>
</section>
<section id="an-overview-of-the-book" class="level2">
<h2 class="anchored" data-anchor-id="an-overview-of-the-book">An Overview of the Book</h2>
<p>…</p>
</section>
<section id="chapters" class="level2">
<h2 class="anchored" data-anchor-id="chapters">Chapters</h2>
<p>In the sections below, I will explore some of the more engaging aspects of the book’s content.</p>
<section id="a-gentle-introduction-to-operational-research" class="level3">
<h3 class="anchored" data-anchor-id="a-gentle-introduction-to-operational-research">A Gentle Introduction to Operational Research</h3>
<p>The authors cater for my (and possibly the larger portion of their audience’s) needs by tackling some rather large misconceptions about computer science and human behaviour. Namely that humans are far too fuzzy-minded, fallible and that the real world is far too complex to benefit from optimisation. Indeed, the authors do state that some problems are known to be intractible due to a near infinite number of potential solutions, however those problems can be defined from the outset. And the rest of life’s challenges may often be reduced to outcomes affected by chance - the search for the right New York apartment being the particular focus for the intro. Briefly introducing the optimal stopping problem of whether to put an offer in for an apartment or to risk losing out on possibly the best apartment on the market by continuing your search provides an accessible and familiar insight to the direction of the book.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>“…spend 37% of your apartment hunt (eleven days, if you’ve given yourself a month for the search) noncommittally exploring options. Leave the checkbook at home; you’re just calibrating. But after that point, be prepared to immediately commit - deposit and all - to the very first place that beats whatever you’ve already seen.” <span class="citation" data-cites="AtLB"><a href="#ref-AtLB" role="doc-biblioref">[2, p. 2]</a></span></p>
</div>
</div>
<p>At that point, the authors hit the reader with a little taste of the magic in this book - that this problem is in many ways solved. That this same type of solution can be applied to a rane of real world problems from parking your car to choosing a long-term partner, the concept that there exists a proof that at 37% of your search time you should immediately flip to committing has an almost Douglas Adams sort of quality to it.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>42: the “Answer to the Ultimate Question of Life, the Universe, and Everything” <span class="citation" data-cites="Hitchhikers"><a href="#ref-Hitchhikers" role="doc-biblioref">[3]</a></span></p>
</div>
</div>
</section>
<section id="optimal-stopping" class="level3">
<h3 class="anchored" data-anchor-id="optimal-stopping">Optimal Stopping</h3>
<p>Chapter 1 of the book dedicates more to explaining the debated origins of what has become known as ‘The Secretary Problem’ - a common description of the Catch-22 described in the introduction. In the context of hiring an employee for example, hiring at random regardless of the candidate’s performance from a pool of 100 candidates would result in success for the employer on average 1% of the time. Success meaning that the employer has selected the best applicant from the pool.</p>
<p>By following the optimal stopping strategy, the average chances of hiring the best candidate within the pool increases to 37%. Whether or not you feel that is a good outcome is sort of subjective, but the authors discuss that this outcome remains stable as you scale up the applicant pool while random recruitment does not - interviewing a million candidates while observing optimal stopping should bag you the best candidate on average 37% of the time. Random recruitment however, would result in successful recruitment of the strongest candidate in 0.0001% of the time.</p>
<p>The example of scaling up this problem prompted me to consider some potential flaws in human behaviour, that would render any recruitment campaign unfair - optimised or otherwise. Standardising the recruitment process is known to be extremely challenging. Treating the problem like trial design, controlling for factors quickly results in confounding variables. If choosing to minimise variation in the appraisal process, you may consider retaining the same panel for each interview. Ensuring that the panel’s sattention and mood are not affected by a demanding interview schedule becomes the next problem. Attempting to control for that results in extending the schedule period, possibly from days to months.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>““…no free lunch” (NFL) theorems… for any algorithm, any elevated performance over one class of problems is offset by performance over another class” <span class="citation" data-cites="NFLTheorem"><a href="#ref-NFLTheorem" role="doc-biblioref">[4]</a></span></p>
</div>
</div>
<p>The secretary problem presumes that the information available to the interviewer about the quality of the candidates is relative rather than absolute. You can compare or rank the candidates but do not have a list of absolute criteria or aptitude tests to measure your candidates against. Any such approach to interviewing would swiftly be decried for lacking any objective threshold, leaving the entire process wide open to human bias.</p>
<p>Another assumption of the secretary problem is that making an offer would guarantee the candidate would accept, while passing up on a candidate would result in losing out on the possibility of recruiting that candidate forever. Few recruitment campaigns could operate under such conditions, however these assumptions could hold more relevance to scenarios such as selecting a parking space or selecting a long-term partner. Possibly. Although humans are complex organisms, the motivations driving that behaviour may lead to stable, predictable outcomes when considering a larger sample size.</p>
<p>Overall, I felt the authors offered an interesting treatment of optimal stopping solutions. The relevance to everyday scenarios piqued my interest and had me thinking of broader implications. I am not wholly convinced that the approach is generalisable to most real-world scenarios, which may violate the problem’s assumptions.</p>
</section>
<section id="sorting" class="level3">
<h3 class="anchored" data-anchor-id="sorting">3: Sorting</h3>
</section>
<section id="caching" class="level3">
<h3 class="anchored" data-anchor-id="caching">4: Caching</h3>
</section>
<section id="overfitting" class="level3">
<h3 class="anchored" data-anchor-id="overfitting">7: Overfitting</h3>
</section>
<section id="game-theory" class="level3">
<h3 class="anchored" data-anchor-id="game-theory">11: Game Theory</h3>
</section>
</section>
<section id="analysis-and-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="analysis-and-evaluation">Analysis and Evaluation</h2>
</section>
<section id="comparisons" class="level2">
<h2 class="anchored" data-anchor-id="comparisons">Comparisons</h2>
</section>
<section id="recommendation" class="level2">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">Recommendation</h2><div id="refs" class="references csl-bib-body" role="list">
<div id="ref-PrinceCCSL" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline"><a href="https://cocosci.princeton.edu/">https://cocosci.princeton.edu/</a></div>
</div>
<div id="ref-AtLB" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">Brian Christian &amp; Tom Griffiths, <em><span class="nocase">Algorithms to Live By</span></em>. <span>William Collins</span>, 2016.</div>
</div>
<div id="ref-Hitchhikers" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">Douglas Adams, <em><span class="nocase">The Hitchhikers Guide to the Galaxy</span></em>. 1981.</div>
</div>
<div id="ref-NFLTheorem" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline">D.H. Wolpert; W.G. Macready, <span>“No free lunch theorems for optimization,”</span> <em>IEEE Transactions on Evolutionary Computation</em>, vol. 1, no. 1, 1997.</div>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>