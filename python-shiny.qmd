---
title: "Python for Shiny"
author: "Rich Leyshon."
toc: true
---
## Python for Shiny is now a thing...

<figure class=center>
  <img src=www/01-python-shiny/shiny-python.png alt="AI-generated drawing of a shiny python.">
  <figcaption>[DALL.E prompt](https://huggingface.co/spaces/dalle-mini/dalle-mini): python logo golden Sparkling glittery bokeh bright.</figcaption>
</figure>

[Python Shiny](https://pypi.org/project/shiny/) celebrates its first year
anniversary on PyPi in July 2023. In case that needs further qualification, this
is the Python-native implementation of the beloved RShiny dashboarding package
that has been available in the R programming framework for over a decade now. 
Python Shiny has benefited from the experience that the developers at
[Posit](https://posit.co/) have gained in building its more mature,
R-flavoured sibling.

Python Shiny has experienced what I would describe as an accelerated evolution
and has the potential to become a front runner in production-grade
applications. Mainly because it adheres to an evaluation strategy which is a bit
'un-pythonic'. Shiny introduces dashboarding with lazy evaluation, meaning that
elements of your code will only be evaluated when there is a need to do so. This
is not always a great idea, particularly for standard scripting purposes. But it
does make event-drive applications more efficient and scalable. More on
[Posit's take on the USP of Python Shiny here](https://posit.co/blog/why-shiny-for-python/).

Let's consider the following example in Python:

```{python}
# In Python
try:
  def failing_print(param_a="Am I lazy?", param_b=absolutely_not):
    print(param_a)
except NameError:
  print("Python woud not allow me to define this function.")

```

Strict (also known as eager) evaluation in Python has triggered an error. I've
had to catch the error above with the try/except clause in order to render this
website. Even though `failing_print()` never calls on `param_b`, Python checks
that the default value of that parameter exists on definition of the function.

Let us now compare to the situation in R.

```{r}
# In R
passing_print <- function(param_a = "Am I lazy?", param_b = yes_you_are){
  print(param_a)
}
print(paste("Does `yes_you_are` exist? : ", exists("yes_you_are")))
passing_print()

```

No exception was raised although the value `yes_you_are` has not been defined.

Lazy evaluation in Python Shiny minimises the work the application needs to
undertake. Values in the app backend will only be re-evaluated as they are
needed and contrasts with more pythonic approaches to dashboarding, such as the
case with the [streamlit package](https://streamlit.io/).

<br>

***
## An Example Python Shiny App

This application is written in Python and served with a free [shinyapps.io](https://www.shinyapps.io/)
account. I made the app to explore the quality of the spatial data available
within [Open Street Map](https://www.openstreetmap.org/) (OSM) data for certain
urban areas. Open Street Map is an open-source, community-maintained source of
transport network data. The files also contain other spatial features, such as
landuse polygons. The quality of this data varies by location, as you may find
in the app. 

The application is pretty straight forward. It uses pandas to read in some
pre-prepared data tables from a data folder. These files were prepared with
a python package called [pyrosm](https://pyrosm.readthedocs.io/en/latest/).
Pyrosm is a useful application for ingesting, assessing & visualising OSM data.
Selecting a city from the dropdowns then clicking the "Go" button will read the
correct table from this little database, then using matplotlib, it visualises
the selected spatial features. The app also presents some simple summary
statistics in tables at the bottom of the page. 

The preparation of the data files is not strictly necessary. You can serve an 
app and have it make external connections to data services to ingest data. In
this instance, I chose to pre-process the data as it helped to improve the
performance of the app. Even so, selecting London or Leeds can result in some
wait times, so please be aware of this. Options for improving the performance 
further could include parallel processing, though that is not implemented here
and is beyond the scope of this little example.

If you'd like to take a look at the application code and have a GitHub account,
[you can access it here](https://github.com/r-leyshon/pyrosm-experiments/blob/main/pyrosm-cities-app/app.py).

<div class=centerdiv>
  <iframe src="https://richleysh84.shinyapps.io/pyrosm-cities-app/" title="Python Shiny Open Street Map Application" style="border:0.3em solid lightgray" align=center></iframe>
<div>


***


## Getting Started with Python Shiny

There would be little value in emulating the excellent [Posit documentation](https://shiny.posit.co/py/) on getting started with Python Shiny.
In combination with the examples provided, a comprehensive introduction to Shiny
is readily available. In this section, I will focus on introducing a minimal
application and then expanding on some of the more subtle considerations. 


### Basic Frontend

### Basic Backend

### Tips

***

## A Year's Progress


### Reactivity


### Modular Dashboard

***

## The Shiny Ecosystem

A nostalgic look at RShiny ecosystem.

### Python Shiny Add-ins

### Python Shiny Wishlist

### Shinyhelper

#### Shinytest

#### DT tables

#### Golem

#### Reactlog

***

## In Review

Final thoughts & sign off
